
# Управление Товарами и Типами Товаров

## Описание проекта

Данное приложение — это система для управления товарами и их типами. Администраторы могут просматривать список товаров и типов товаров, создавать новые, обновлять информацию о существующих товарах, массово добавлять товары, а также изменять количество товаров на складе.

## Основные возможности

- **Управление товарами**: создание, просмотр, обновление и удаление товаров.
- **Управление типами товаров**: создание, просмотр, обновление и удаление типов товаров.
- **Множественное добавление товаров**: возможность добавлять несколько товаров в одном запросе.
- **Обновление количества товара**: изменение количества товара на складе (увеличение или уменьшение).
- **Аутентификация и авторизация** с использованием JWT-токенов.
- **Фильтрация и сортировка товаров**: возможность `фильтровать` товары по различным параметрам, включая название, дату обновления и цену, и `сортировать` их по названию, дате обновления или цене.

## Роли и права пользователей

- **Авторизованный пользователь**: имеет полный доступ к функционалу.
`Примечание: Пользователи создаются исключительно через админ-панель`

## Технологии

- **Python**
- **Django REST Framework**
- **Pytest**
- **Git**
- **SQLite**
- **SimpleJWT**
- **Djoser**
- **Flake8**

## Описание моделей

### Product

Модель товара, содержит основные данные о товаре.

- **Поля**:
  - `name`: Название товара.
  - `amount`: Количество на складе.
  - `barcode`: Штрихкод (с валидацией и индексом).
  - `date_updated`: Дата обновления (автоматически).
  - `type`: Тип товара (ссылка на `ProductType`).
  - `is_active`: Статус активности.

- **Метаданные**:
  - `verbose_name`: "товар"
  - `verbose_name_plural`: "Товары"
  - `ordering`: Сортировка по дате обновления.

### ProductType

Тип товара с названием и описанием.

- **Поля**:
  - `name`: Название типа.
  - `description`: Описание.

- **Метаданные**:
  - `verbose_name`: "тип товара"
  - `verbose_name_plural`: "Типы товаров"
  - `ordering`: По названию.

### ProductPrice

Цена товара с указанием валюты.

- **Поля**:
  - `currency`: Валюта (RUB, USD, EUR, CNY).
  - `price`: Цена.
  - `product`: Привязка к товару (связь `OneToOne`).

- **Метаданные**:
  - `verbose_name`: "стоимость"
  - `verbose_name_plural`: "Стоимости"
  - `ordering`: По цене.


## Как запустить проект

1. **Клонировать репозиторий и перейти в него в командной строке:**

    ```bash
    git clone git@github.com:ArtemBalanoff/test_task-OpenService.git
    cd test_task-OpenService
    ```

2. **Создать и активировать виртуальное окружение:**

    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```

3. **Установить зависимости из файла `reqs.txt`:**

    ```bash
    python3 -m pip install --upgrade pip
    pip install -r reqs.txt
    ```

4. **Выполнить миграции:**

    ```bash
    python3 manage.py migrate
    ```

5. **Запустить Pytest тесты:**

    ```bash
    pytest
    ```

6. **Запустить проект:**

    ```bash
    python3 manage.py runserver
    ```

## Доступные эндпоинты

### Аутентификация

- **POST** - Получение JWT-токена

    ```
    api/v1/auth/jwt/create/
    ```

- **POST** - Обновление JWT-токена

    ```
    api/v1/auth/jwt/refresh/
    ```

- **POST** - Верификация JWT-токена

    ```
    api/v1/auth/jwt/verify/
    ```

### Управление товарами

- **GET** - Получение списка всех товаров

    ```
    api/v1/products/
    ```

    Параметры запроса:

    - **ordering**: сортировка по полям `name`, `date_updated`, `price`.
    - **filtering**: можно фильтровать по `name`, `min_price`, `max_price`, `date_updated_after`, `date_updated_before`, `is_active`, `currency`.

- **POST** - Создание нового товара

    ```
    api/v1/products/
    ```

    Тело запроса:

    ```json
    {
        "name": "Название товара",
        "type": <id типа товара>,
        "price": {
            "price": <цена>,
            "currency": <валюта>
        },
        "amount": <количество>
    }
    ```

- **GET** - Получение информации о товаре по ID

    ```
    api/v1/products/<pk>/
    ```

- **PATCH** - Частичное обновление товара по ID

    ```
    api/v1/products/<pk>/
    ```

    Тело запроса может содержать любые поля товара для обновления кроме amount `(редактируется отдельно)`.

- **DELETE** - Удаление товара по ID

    ```
    api/v1/products/<pk>/
    ```

- **PATCH** - Обновление количества товара (увеличение или уменьшение)

    ```
    api/v1/products/<pk>/update-amount/
    ```

    Тело запроса:

    ```json
    {
        "amount_delta": <разница в количестве>
    }
    ```

- **POST** - Множественное добавление товаров

    ```
    api/v1/products/bulk-create/
    ```

    Тело запроса:

    ```json
    {
        "products": [
            {
                "name": "Товар 1",
                "type": <id типа товара>,
                "price": {
                    "price": <цена>,
                    "currency": <валюта>
                },
                "amount": <количество>
            },
            {
                "name": "Товар 2",
                "type": <id типа товара>,
                "price": {
                    "price": <цена>,
                    "currency": <валюта>
                },
                "amount": <количество>
            }
        ]
    }
    ```

### Управление типами товаров

- **GET** - Получение списка всех типов товаров

    ```
    api/v1/product-types/
    ```

- **POST** - Создание нового типа товара

    ```
    api/v1/product-types/
    ```

    Тело запроса:

    ```json
    {
        "name": "Название типа товара",
        "description": "Описание типа товара"
    }
    ```

- **GET** - Получение информации о типе товара по ID

    ```
    api/v1/product-types/<pk>/
    ```

- **PATCH** - Частичное обновление типа товара по ID

    ```
    api/v1/product-types/<pk>/
    ```

- **DELETE** - Удаление типа товара по ID

    ```
    api/v1/product-types/<pk>/
    ```